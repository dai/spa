Annotated source code at http://dejanstrbac.github.com/spa